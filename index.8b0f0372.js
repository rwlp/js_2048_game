!function(){function t(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function e(e,i){var n=t(e,i,"get");return n.get?n.get.call(e):n.value}function i(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function n(t,e,n){i(t,e),e.set(t,n)}function a(e,i,n){var a=t(e,i,"set");return!function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(e,a,n),n}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function l(t,e){i(t,e),e.add(t)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function o(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,void 0);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=new WeakMap,c=new WeakMap,u=new WeakMap,f=new WeakMap,d=new WeakMap,v=new WeakSet,y=new WeakSet,m=new WeakSet,p=new WeakSet,g=new WeakSet,w=new WeakSet;function k(){for(var t,i=[],n=0;n<e(this,h);n++)for(var a=0;a<e(this,h);a++)0===e(this,u)[n][a]&&i.push([n,a]);i.length>0&&(t=Math.floor(Math.random()*i.length),e(this,u)[i[t][0]][i[t][1]]=9>Math.floor(10*Math.random())?2:4)}function S(){for(var t,i=0;i<e(this,h);i++)for(var n=i;n<e(this,h);n++)t=e(this,u)[i][n],e(this,u)[i][n]=e(this,u)[n][i],e(this,u)[n][i]=t}function b(){e(this,u).forEach(function(t,e,i){return i[e].reverse()})}function L(){for(var t=[],i=0;i<e(this,h);i++)for(var n=0;n<e(this,h);n++){if(0===e(this,u)[n][i]||(t.push(void 0!==e(this,u)[n-1]?e(this,u)[n-1][i]:void 0),t.push(void 0!==e(this,u)[n+1]?e(this,u)[n+1][i]:void 0),t.push(e(this,u)[n][i+1]),t.push(e(this,u)[n][i-1]),t.includes(0)||t.includes(e(this,u)[n][i])))return!1;t=[]}return!0}function A(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e(this,u);return t.map(function(t){return o(t)})}function E(){if("playing"===e(this,f)){var t=this,i=s(this,g,A).call(this).flat();for(var n in e(this,u))!function(i){for(var n=e(t,u)[i].filter(function(t){return 0!==t}),s=0;s<n.length;){if(n[s+1]===n[s]){n[s+1]=0,n[s]*=2,a(t,c,e(t,c)+n[s]),2048===n[s]&&a(t,f,"win"),s+=2;continue}s++}n=n.filter(function(t){return 0!==t}),e(t,u)[i]=o(n).concat(o(Array(e(t,h)-n.length).fill(0)))}(n);e(this,u).flat().some(function(t,e){return t!==i[e]})&&s(this,v,k).call(this)}a(this,f,s(this,p,L).call(this)?"lose":e(this,f))}var C=new(function(){var t;function i(t){if(!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),l(this,v),l(this,y),l(this,m),l(this,p),l(this,g),l(this,w),n(this,h,{writable:!0,value:4}),n(this,c,{writable:!0,value:0}),n(this,u,{writable:!0,value:[]}),n(this,f,{writable:!0,value:""}),n(this,d,{writable:!0,value:void 0}),t)a(this,u,s(this,g,A).call(this,t)),a(this,d,s(this,g,A).call(this));else{for(var r in a(this,u,Array(e(this,h)).fill(0)),e(this,u))e(this,u)[r]=Array(e(this,h)).fill(0);a(this,d,s(this,g,A).call(this))}a(this,f,"idle")}return t=[{key:"moveLeft",value:function(){s(this,w,E).call(this)}},{key:"moveRight",value:function(){s(this,m,b).call(this),s(this,w,E).call(this),s(this,m,b).call(this)}},{key:"moveUp",value:function(){s(this,y,S).call(this),s(this,w,E).call(this),s(this,y,S).call(this)}},{key:"moveDown",value:function(){s(this,y,S).call(this),s(this,m,b).call(this),s(this,w,E).call(this),s(this,m,b).call(this),s(this,y,S).call(this)}},{key:"getScore",value:function(){return e(this,c)}},{key:"getState",value:function(){return s(this,g,A).call(this)}},{key:"getStatus",value:function(){return e(this,f)}},{key:"setStatus",value:function(t){a(this,f,t)}},{key:"start",value:function(){a(this,c,0),a(this,f,"playing"),a(this,u,s(this,g,A).call(this,e(this,d))),s(this,v,k).call(this),s(this,v,k).call(this)}},{key:"restart",value:function(){a(this,c,0),a(this,f,"playing"),a(this,u,s(this,g,A).call(this,e(this,d))),a(this,f,"idle")}}],function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(i.prototype,t),i}()),W=document.getElementsByClassName("field-cell"),M=document.getElementsByClassName("game-score")[0],T=document.getElementsByClassName("button")[0],j=document.getElementsByClassName("message"),x={2:"field-cell--2",4:"field-cell--4",8:"field-cell--8",16:"field-cell--16",32:"field-cell--32",64:"field-cell--64",128:"field-cell--128",256:"field-cell--256",512:"field-cell--512",1024:"field-cell--1024",2048:"field-cell--2048"},N={idle:function(){C.setStatus("playing"),N.playing(),j[0].classList.add("hidden"),j[1].classList.add("hidden"),j[2].classList.add("hidden"),j[3].classList.remove("hidden")},playing:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++)W[4*t+e].textContent=C.getState()[t][e]||"";B(),M.textContent=C.getScore()},win:function(){N.playing(),j[0].classList.add("hidden"),j[1].classList.remove("hidden"),j[2].classList.add("hidden"),j[3].classList.add("hidden")},lose:function(){N.playing(),j[0].classList.remove("hidden"),j[1].classList.add("hidden"),j[2].classList.add("hidden"),j[3].classList.add("hidden")}},B=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=W[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var s=n.value;s.className=x[s.textContent]?"field-cell "+x[s.textContent]:"field-cell"}}catch(t){e=!0,i=t}finally{try{t||null==a.return||a.return()}finally{if(e)throw i}}};document.addEventListener("keydown",function(t){"playing"===C.getStatus()&&("ArrowDown"===t.key?(C.moveDown(),function(t){N[t]()}(C.getStatus())):"ArrowUp"===t.key?(C.moveUp(),function(t){N[t]()}(C.getStatus())):"ArrowRight"===t.key?(C.moveRight(),function(t){N[t]()}(C.getStatus())):"ArrowLeft"===t.key&&(C.moveLeft(),function(t){N[t]()}(C.getStatus())))}),T.addEventListener("click",function(t){C.start(),function(t){N[t]()}(C.getStatus()),B(),T.classList.add("restart")})}();
//# sourceMappingURL=index.8b0f0372.js.map
